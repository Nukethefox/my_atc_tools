<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="style.css">
<meta charset="UTF-8">
<title>TL Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

</head>
<body>

<div class="page">

<div class="navbar">
  <ul style="display: flex; list-style: none;">
    <li><button class="navbutton" onclick="location.href='index.html'">HOME</button></li>
    <li><button class="navbutton" onclick="location.href='units.html'">UNITS CONVERSION</button></li>
    <li><button class="navbutton selected" onclick="location.href='qnh.html'">QNH & TA/TL</button></li>
    <li><button class="navbutton" onclick="location.href='taxi_calc.html'">TAXI FLOW MANAGER</button></li>
    <li><button class="navbutton" onclick="location.href='speed_calc.html'">TRAFFIC SPEEDS & CONFLICTS</button></li>
    <li><button class="navbutton" onclick="location.href='traffic_sep.html'">WAKE TURBULENCE SEPARATION</button></li>

  </ul>
</div>

<h1>TRANSITION LEVEL CALCULATOR</h1>

<form id="QNHandTA">
    <input type="number" id="qnh" placeholder="QNH (hPa)" required>
    <select style="cursor:pointer;" id="transaltitude" required>
      <option value="3000">3000</option>
      <option value="3500">3500</option>
      <option value="4000">4000</option>
      <option value="4500">4500</option>
      <option value="5000">5000</option>
      <option value="5500">5500</option>
      <option value="6000" selected>6000 (Spain STD)</option>
      <option value="6500">6500</option>
      <option value="7000">7000 (LEGR)</option>
      <option value="7500">7500</option>
      <option value="8000">8000 (LESU)</option>
      <option value="8500">8500</option>
      <option value="9000">9000</option>
      <option value="9500">9500</option>
      <option value="10000">10000</option>
      <option value="10500">10500</option>
      <option value="11000">11000</option>
      <option value="11500">11500</option>
      <option value="12000">12000</option>
      <option value="12500">12500</option>
      <option value="13000">13000 (LEMD)</option>
      <option value="13500">13500</option>
      <option value="14000">14000</option>
      <option value="14500">14500</option>
      <option value="15000">15000</option>
      <option value="15500">15500</option>
      <option value="16000">16000</option>
    </select>
    <button type="submit">Calculate</button>
</form>

<div id="resultqnh"></div>
<p style="position: fixed; bottom: 0; color: white; font-weight: 900; background-color: red;">FOR FLIGHT SIMULATION PURPOSES ONLY!</p>
</div>

<script>
const table = {
  3000: [60,55,50,45,40,35],
  3500: [65,60,55,50,45,40],
  4000: [70,65,60,55,50,45],
  4500: [75,70,65,60,55,50],
  5000: [80,75,70,65,60,55],
  5500: [85,80,75,70,65,60],
  6000: [90,85,80,75,70,65],
  6500: [95,90,85,80,75,70],
  7000: [100,95,90,85,80,75],
  7500: [105,100,95,90,85,80],
  8000: [110,105,100,95,90,85],
  8500: [115,110,105,100,95,90],
  9000: [120,115,110,105,100,95],
  9500: [125,120,115,110,105,100],
 10000: [130,125,120,115,110,105],
 10500: [135,130,125,120,115,110],
 11000: [140,135,130,125,120,115],
 11500: [145,140,135,130,125,120],
 12000: [150,145,140,135,130,125],
 12500: [155,150,145,140,135,130],
 13000: [160,155,150,145,140,135],
 13500: [165,160,155,150,145,140],
 14000: [170,165,160,155,150,145],
 14500: [175,170,165,160,155,150],
 15000: [180,175,170,165,160,155],
 15500: [185,180,175,170,165,160],
 16000: [190,185,180,175,170,165],
};

const qnhRanges = [
  [942.2,959.4],
  [959.5,977.1],
  [977.2,995.0],
  [995.1,1013.2],
  [1013.3,1031.6],
  [1031.7,1050.3],
];

document.getElementById("QNHandTA").addEventListener("submit", function(e){
  e.preventDefault();
  const qnh = parseInt(document.getElementById("qnh").value);
  const ta = document.getElementById("transaltitude").value;

  let col = -1;
  for(let i=0; i<qnhRanges.length; i++){
    if(qnh >= qnhRanges[i][0] && qnh <= qnhRanges[i][1]){
      col = i;
      break;
    }
  }

  let resultqnh = "Invalid QNH";
  if(col !== -1 && table[ta]){
    let tl = table[ta][col];
    resultqnh = "TL " + String(tl).padStart(3,"0");
  }

  document.getElementById("resultqnh").textContent = resultqnh;
});
</script>

</body>
</html>
